---
created: '2025-12-03T20:01:54.939570'
id: 20251203T200154939556000
tags:
- variety
- modification
- files
- reference
title: Variety - Key Files for Modification
type: permanent
updated: '2025-12-03T20:01:54.939570'
---

# Variety - Key Files for Modification

# Key Files for Modifying Variety

## High-Impact Files

### 1. VarietyWindow.py (variety/VarietyWindow.py)
- **Lines:** ~2000+ (largest file)
- **Purpose:** Central controller
- **Caution:** Tightly coupled, changes here affect everything
- **Key methods:**
  - `reload_config()` - Configuration changes
  - `do_set_wp()` - Wallpaper setting pipeline
  - `download_thread()` - Background download logic
  - `process_command()` - CLI command handling

### 2. Options.py (variety/Options.py)
- **Purpose:** Configuration schema
- **Modify to:** Add new settings, change defaults
- **Key attributes:** All config options as class attributes

### 3. set_wallpaper script (data/scripts/set_wallpaper)
- **Purpose:** External script called to set wallpaper
- **Modify to:** Support new desktop environments, add effects
- **User copy:** ~/.config/variety/scripts/set_wallpaper

### 4. indicator.py (variety/indicator.py)
- **Purpose:** System tray indicator menu
- **Modify to:** Add new menu items, change UI

### 5. PreferencesVarietyDialog.py
- **Purpose:** Preferences window UI logic
- **Modify to:** Add new preference pages/options

## Plugin Files (Easy Extension Points)

### Add New Image Source
1. Create file in `variety/plugins/builtin/downloaders/`
2. Extend `SimpleDownloader` or `ConfigurableImageSource`
3. Implement required methods

### Add New Quote Source
1. Create file in `variety/plugins/builtin/quotes/`
2. Extend `IQuoteSource`
3. Implement `get_random()`, optionally `get_for_keyword()`, `get_for_author()`

## Configuration Files
| File | Purpose |
|------|---------|
| `variety.conf` | Main configuration |
| `variety.desktop.in` | Desktop entry template |
| `variety-autostart.desktop.template` | Autostart template |
| `data/ui/*.ui` | GTK UI definitions |

## Test Files
All in `tests/` directory, prefixed with `Test*.py`
- Good reference for understanding API usage
- Run with: `python -m pytest tests/`