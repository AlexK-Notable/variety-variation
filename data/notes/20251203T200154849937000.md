---
created: '2025-12-03T20:01:54.849951'
id: 20251203T200154849937000
tags:
- variety
- plugins
- downloaders
- extension
title: Variety - Plugin System Deep Dive
type: permanent
updated: '2025-12-03T20:01:54.849952'
---

# Variety - Plugin System Deep Dive

# Variety Plugin System

## Plugin Hierarchy

```
IPlugin (jumble/IPlugin.py)
  └── IVarietyPlugin (variety/plugins/IVarietyPlugin.py)
      ├── ImageSource - Base for all image sources
      │   ├── SimpleDownloader - Single-source downloaders
      │   │   └── APODDownloader, BingDownloader, UnsplashDownloader, etc.
      │   └── ConfigurableImageSource - User-configurable sources
      │       └── WallhavenSource, RedditSource, FlickrSource, etc.
      ├── IQuoteSource - Quote providers
      │   └── GoodreadsSource, FortuneSource, LocalFilesSource, etc.
      └── IDisplayModesPlugin - Display mode handlers
          └── GnomeDisplayModesPlugin, ResizingDisplayModesPlugin, etc.
```

## Plugin Loading (Jumble)
- Located in `jumble/` directory
- `Jumble.py` scans plugin folders for Python files
- Plugins must have `get_info()` classmethod returning metadata
- Loaded from:
  1. `variety/plugins/builtin/` - Built-in plugins
  2. `~/.config/variety/plugins/` - User plugins

## Creating a New Image Source

### Simple Source (no configuration)
```python
from variety.plugins.downloaders.SimpleDownloader import SimpleDownloader

class MyDownloader(SimpleDownloader):
    @classmethod
    def get_info(cls):
        return {
            "name": "My Source",
            "description": "Description",
            "author": "Author",
            "version": "1.0"
        }
    
    def get_source_type(self): return "my-source"
    def get_source_name(self): return "My Source"
    def fill_queue(self):
        # Add items to self.queue
        self.queue.append(QueueItem(origin_url, image_url, extra_metadata))
```

### Configurable Source (user can add with query/URL)
```python
from variety.plugins.downloaders.ConfigurableImageSource import ConfigurableImageSource

class MySource(ConfigurableImageSource):
    def validate(self, config): 
        # Return (True, None) or (False, error_message)
        pass
    
    def create_downloader(self, config):
        # Return a Downloader instance
        pass
    
    def get_ui_instruction(self): pass
    def get_ui_short_instruction(self): pass
    def get_ui_short_description(self): pass
```

## Built-in Downloaders
| Source | Type | File |
|--------|------|------|
| NASA APOD | Simple | APODDownloader.py |
| Bing Photo | Simple | BingDownloader.py |
| Unsplash | Simple + Config | UnsplashDownloader.py |
| Wallhaven | Configurable | WallhavenDownloader.py |
| Reddit | Configurable | RedditDownloader.py |
| Flickr | Configurable | FlickrDownloader.py |
| ArtStation | Configurable | ArtStationDownloader.py |
| Media RSS | Configurable | MediaRSSDownloader.py |

## Throttling System
Sources can define rate limits:
```python
def get_default_throttling(self):
    return Throttling(
        max_downloads_per_hour=20,
        max_queue_fills_per_hour=1
    )
```