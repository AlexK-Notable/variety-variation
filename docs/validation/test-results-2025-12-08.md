============================= test session starts ==============================
platform linux -- Python 3.13.7, pytest-9.0.1, pluggy-1.6.0 -- /usr/bin/python
cachedir: .pytest_cache
benchmark: 5.2.3 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /home/komi/repos/variety-variation
configfile: pyproject.toml
plugins: benchmark-5.2.3, cov-7.0.0, typeguard-4.4.4, anyio-4.12.0
collecting ... collected 324 items

tests/smart_selection/benchmarks/test_bench_database.py::TestDatabaseBenchmarks::test_bench_get_all_images PASSED [  0%]
tests/smart_selection/benchmarks/test_bench_database.py::TestDatabaseBenchmarks::test_bench_get_image_by_path PASSED [  0%]
tests/smart_selection/benchmarks/test_bench_database.py::TestDatabaseBenchmarks::test_bench_get_favorite_images PASSED [  0%]
tests/smart_selection/benchmarks/test_bench_database.py::TestDatabaseBenchmarks::test_bench_upsert_image PASSED [  1%]
tests/smart_selection/benchmarks/test_bench_database.py::TestDatabaseBenchmarks::test_bench_record_image_shown PASSED [  1%]
tests/smart_selection/benchmarks/test_bench_database.py::TestDatabaseBenchmarks::test_bench_get_all_sources PASSED [  1%]
tests/smart_selection/benchmarks/test_bench_database.py::TestDatabaseBenchmarks::test_bench_get_source PASSED [  2%]
tests/smart_selection/benchmarks/test_bench_database.py::TestDatabaseBenchmarks::test_bench_upsert_palette PASSED [  2%]
tests/smart_selection/benchmarks/test_bench_database.py::TestDatabaseBenchmarks::test_bench_get_palette PASSED [  2%]
tests/smart_selection/benchmarks/test_bench_indexing.py::TestIndexingBenchmarks::test_bench_index_directory PASSED [  3%]
tests/smart_selection/benchmarks/test_bench_indexing.py::TestIndexingBenchmarks::test_bench_scan_directory PASSED [  3%]
tests/smart_selection/benchmarks/test_bench_indexing.py::TestIndexingBenchmarks::test_bench_index_single_file PASSED [  3%]
tests/smart_selection/benchmarks/test_bench_indexing.py::TestIndexingBenchmarks::test_bench_reindex_existing PASSED [  4%]
tests/smart_selection/benchmarks/test_bench_palette.py::TestPaletteBenchmarks::test_bench_extract_palette PASSED [  4%]
tests/smart_selection/benchmarks/test_bench_palette.py::TestPaletteBenchmarks::test_bench_palette_similarity PASSED [  4%]
tests/smart_selection/benchmarks/test_bench_palette.py::TestPaletteBenchmarks::test_bench_create_palette_record PASSED [  4%]
tests/smart_selection/benchmarks/test_bench_palette.py::TestPaletteBenchmarks::test_bench_extract_batch_palettes PASSED [  5%]
tests/smart_selection/benchmarks/test_bench_selection.py::TestSelectionBenchmarks::test_bench_select_single PASSED [  5%]
tests/smart_selection/benchmarks/test_bench_selection.py::TestSelectionBenchmarks::test_bench_select_batch PASSED [  5%]
tests/smart_selection/benchmarks/test_bench_selection.py::TestSelectionBenchmarks::test_bench_select_with_constraints PASSED [  6%]
tests/smart_selection/benchmarks/test_bench_selection.py::TestSelectionBenchmarks::test_bench_weight_calculation PASSED [  6%]
tests/smart_selection/benchmarks/test_bench_selection.py::TestSelectionBenchmarks::test_bench_record_shown PASSED [  6%]
tests/smart_selection/benchmarks/test_bench_selection.py::TestSelectionBenchmarks::test_bench_disabled_selection PASSED [  7%]
tests/smart_selection/e2e/test_edge_cases.py::TestDeletedFileHandling::test_deleted_file_not_selected SKIPPED [  7%]
tests/smart_selection/e2e/test_edge_cases.py::TestDeletedFileHandling::test_deleted_file_skipped_in_reindex SKIPPED [  7%]
tests/smart_selection/e2e/test_edge_cases.py::TestEmptyStates::test_empty_directory_indexes_nothing PASSED [  8%]
tests/smart_selection/e2e/test_edge_cases.py::TestEmptyStates::test_select_from_empty_returns_empty PASSED [  8%]
tests/smart_selection/e2e/test_edge_cases.py::TestEmptyStates::test_select_more_than_available PASSED [  8%]
tests/smart_selection/e2e/test_edge_cases.py::TestConstraintEdgeCases::test_impossible_constraints_return_empty PASSED [  8%]
tests/smart_selection/e2e/test_edge_cases.py::TestConstraintEdgeCases::test_narrow_aspect_ratio_constraint PASSED [  9%]
tests/smart_selection/e2e/test_edge_cases.py::TestConcurrentAccess::test_multiple_readers_work PASSED [  9%]
tests/smart_selection/e2e/test_edge_cases.py::TestInvalidInputHandling::test_record_nonexistent_image PASSED [  9%]
tests/smart_selection/e2e/test_edge_cases.py::TestInvalidInputHandling::test_index_nonexistent_directory_raises PASSED [ 10%]
tests/smart_selection/e2e/test_edge_cases.py::TestInvalidInputHandling::test_select_zero_count PASSED [ 10%]
tests/smart_selection/e2e/test_edge_cases.py::TestInvalidInputHandling::test_select_negative_count PASSED [ 10%]
tests/smart_selection/e2e/test_edge_cases.py::TestNonImageFileHandling::test_non_image_files_ignored PASSED [ 11%]
tests/smart_selection/e2e/test_persistence.py::TestDatabasePersistence::test_database_survives_restart PASSED [ 11%]
tests/smart_selection/e2e/test_persistence.py::TestDatabasePersistence::test_source_tracking_persists PASSED [ 11%]
tests/smart_selection/e2e/test_persistence.py::TestConfigChanges::test_config_changes_affect_selection PASSED [ 12%]
tests/smart_selection/e2e/test_persistence.py::TestConfigChanges::test_disabled_config_uses_uniform_selection PASSED [ 12%]
tests/smart_selection/e2e/test_persistence.py::TestPalettesPersistence::test_palettes_persist_across_sessions PASSED [ 12%]
tests/smart_selection/e2e/test_workflows.py::TestFreshStartWorkflow::test_fresh_database_index_and_select PASSED [ 12%]
tests/smart_selection/e2e/test_workflows.py::TestFreshStartWorkflow::test_empty_database_returns_empty_selection PASSED [ 13%]
tests/smart_selection/e2e/test_workflows.py::TestSelectionLifecycleWorkflow::test_recently_shown_image_less_likely PASSED [ 13%]
tests/smart_selection/e2e/test_workflows.py::TestSelectionLifecycleWorkflow::test_times_shown_increments PASSED [ 13%]
tests/smart_selection/e2e/test_workflows.py::TestColorAwareWorkflow::test_color_similar_images_preferred PASSED [ 14%]
tests/smart_selection/e2e/test_workflows.py::TestColorAwareWorkflow::test_palette_extraction_on_record_shown PASSED [ 14%]
tests/smart_selection/e2e/test_workflows.py::TestFavoritesWorkflow::test_favorites_boosted_in_selection PASSED [ 14%]
tests/smart_selection/e2e/test_workflows.py::TestSourceRotationWorkflow::test_source_rotation_balances_selection PASSED [ 15%]
tests/smart_selection/e2e/test_workflows.py::TestConstraintCombinations::test_multiple_constraints_combined PASSED [ 15%]
tests/smart_selection/test_color_constraints.py::TestGetSmartColorConstraints::test_adaptive_returns_constraints_based_on_time PASSED [ 15%]
tests/smart_selection/test_color_constraints.py::TestGetSmartColorConstraints::test_adaptive_time_periods_are_valid PASSED [ 16%]
tests/smart_selection/test_color_constraints.py::TestGetSmartColorConstraints::test_converts_similarity_to_decimal PASSED [ 16%]
tests/smart_selection/test_color_constraints.py::TestGetSmartColorConstraints::test_cool_temperature_palette PASSED [ 16%]
tests/smart_selection/test_color_constraints.py::TestGetSmartColorConstraints::test_neutral_temperature_palette PASSED [ 16%]
tests/smart_selection/test_color_constraints.py::TestGetSmartColorConstraints::test_returns_none_when_disabled PASSED [ 17%]
tests/smart_selection/test_color_constraints.py::TestGetSmartColorConstraints::test_returns_selection_constraints PASSED [ 17%]
tests/smart_selection/test_color_constraints.py::TestGetSmartColorConstraints::test_warm_temperature_palette PASSED [ 17%]
tests/smart_selection/test_config.py::TestSelectionConfig::test_import_selection_config PASSED [ 18%]
tests/smart_selection/test_config.py::TestSelectionConfig::test_selection_config_custom_values PASSED [ 18%]
tests/smart_selection/test_config.py::TestSelectionConfig::test_selection_config_default_values PASSED [ 18%]
tests/smart_selection/test_config.py::TestSelectionConfig::test_selection_config_has_behavior_fields PASSED [ 19%]
tests/smart_selection/test_config.py::TestSelectionConfig::test_selection_config_has_recency_fields PASSED [ 19%]
tests/smart_selection/test_config.py::TestSelectionConfig::test_selection_config_has_weight_fields PASSED [ 19%]
tests/smart_selection/test_config.py::TestSelectionConfig::test_selection_config_recency_decay_options PASSED [ 20%]
tests/smart_selection/test_config.py::TestConfigSerialization::test_config_from_dict PASSED [ 20%]
tests/smart_selection/test_config.py::TestConfigSerialization::test_config_from_dict_ignores_unknown_keys PASSED [ 20%]
tests/smart_selection/test_config.py::TestConfigSerialization::test_config_from_dict_with_missing_keys PASSED [ 20%]
tests/smart_selection/test_config.py::TestConfigSerialization::test_config_to_dict PASSED [ 21%]
tests/smart_selection/test_database.py::TestImageDatabase::test_database_creates_file PASSED [ 21%]
tests/smart_selection/test_database.py::TestImageDatabase::test_database_creates_images_table PASSED [ 21%]
tests/smart_selection/test_database.py::TestImageDatabase::test_database_creates_palettes_table PASSED [ 22%]
tests/smart_selection/test_database.py::TestImageDatabase::test_database_creates_sources_table PASSED [ 22%]
tests/smart_selection/test_database.py::TestImageDatabase::test_import_image_database PASSED [ 22%]
tests/smart_selection/test_database.py::TestImageCRUD::test_delete_image PASSED [ 23%]
tests/smart_selection/test_database.py::TestImageCRUD::test_get_all_images PASSED [ 23%]
tests/smart_selection/test_database.py::TestImageCRUD::test_get_favorite_images PASSED [ 23%]
tests/smart_selection/test_database.py::TestImageCRUD::test_get_image_returns_none_for_nonexistent PASSED [ 24%]
tests/smart_selection/test_database.py::TestImageCRUD::test_get_images_by_source PASSED [ 24%]
tests/smart_selection/test_database.py::TestImageCRUD::test_insert_image PASSED [ 24%]
tests/smart_selection/test_database.py::TestImageCRUD::test_record_image_shown PASSED [ 25%]
tests/smart_selection/test_database.py::TestImageCRUD::test_update_image PASSED [ 25%]
tests/smart_selection/test_database.py::TestImageCRUD::test_upsert_image_inserts_new PASSED [ 25%]
tests/smart_selection/test_database.py::TestImageCRUD::test_upsert_image_updates_existing PASSED [ 25%]
tests/smart_selection/test_database.py::TestSourceCRUD::test_get_all_sources PASSED [ 26%]
tests/smart_selection/test_database.py::TestSourceCRUD::test_get_source_returns_none_for_nonexistent PASSED [ 26%]
tests/smart_selection/test_database.py::TestSourceCRUD::test_record_source_shown PASSED [ 26%]
tests/smart_selection/test_database.py::TestSourceCRUD::test_upsert_source PASSED [ 27%]
tests/smart_selection/test_database.py::TestPaletteCRUD::test_get_images_with_palettes PASSED [ 27%]
tests/smart_selection/test_database.py::TestPaletteCRUD::test_get_images_without_palettes PASSED [ 27%]
tests/smart_selection/test_database.py::TestPaletteCRUD::test_get_palette_returns_none_for_nonexistent PASSED [ 28%]
tests/smart_selection/test_database.py::TestPaletteCRUD::test_upsert_palette PASSED [ 28%]
tests/smart_selection/test_database.py::TestDatabaseContextManager::test_context_manager PASSED [ 28%]
tests/smart_selection/test_database.py::TestDatabaseThreadSafety::test_concurrent_inserts_are_thread_safe PASSED [ 29%]
tests/smart_selection/test_database.py::TestDatabaseThreadSafety::test_concurrent_reads_and_writes_are_thread_safe PASSED [ 29%]
tests/smart_selection/test_database.py::TestDatabaseThreadSafety::test_record_shown_is_thread_safe PASSED [ 29%]
tests/smart_selection/test_database.py::TestDatabaseResilience::test_wal_mode_enabled PASSED [ 29%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_get_freshness_counts_boundary_values PASSED [ 30%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_get_freshness_counts_empty_database PASSED [ 30%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_get_freshness_counts_with_data PASSED [ 30%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_get_hue_counts_empty_database PASSED [ 31%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_get_hue_counts_neutral_grayscale PASSED [ 31%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_get_hue_counts_with_data PASSED [ 31%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_get_lightness_counts_boundary_values PASSED [ 32%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_get_lightness_counts_empty_database PASSED [ 32%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_get_lightness_counts_with_data PASSED [ 32%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_get_saturation_counts_empty_database PASSED [ 33%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_get_saturation_counts_with_data PASSED [ 33%]
tests/smart_selection/test_database.py::TestStatisticsQueries::test_statistics_queries_are_thread_safe PASSED [ 33%]
tests/smart_selection/test_indexer.py::TestImageIndexer::test_import_image_indexer PASSED [ 33%]
tests/smart_selection/test_indexer.py::TestImageIndexer::test_index_directory_creates_sources PASSED [ 34%]
tests/smart_selection/test_indexer.py::TestImageIndexer::test_index_directory_marks_favorites PASSED [ 34%]
tests/smart_selection/test_indexer.py::TestImageIndexer::test_index_directory_populates_database PASSED [ 34%]
tests/smart_selection/test_indexer.py::TestImageIndexer::test_index_directory_skips_existing_unchanged PASSED [ 35%]
tests/smart_selection/test_indexer.py::TestImageIndexer::test_index_directory_updates_changed PASSED [ 35%]
tests/smart_selection/test_indexer.py::TestImageIndexer::test_index_image_derives_source_id PASSED [ 35%]
tests/smart_selection/test_indexer.py::TestImageIndexer::test_index_image_extracts_metadata PASSED [ 36%]
tests/smart_selection/test_indexer.py::TestImageIndexer::test_indexer_creation PASSED [ 36%]
tests/smart_selection/test_indexer.py::TestImageIndexer::test_scan_directory_finds_images PASSED [ 36%]
tests/smart_selection/test_indexer.py::TestImageIndexer::test_scan_directory_recursive PASSED [ 37%]
tests/smart_selection/test_indexer.py::TestIndexerImageFormats::test_indexes_jpg PASSED [ 37%]
tests/smart_selection/test_indexer.py::TestIndexerImageFormats::test_indexes_png PASSED [ 37%]
tests/smart_selection/test_indexer.py::TestIndexerImageFormats::test_indexes_webp PASSED [ 37%]
tests/smart_selection/test_indexer.py::TestIndexerImageFormats::test_skips_non_images PASSED [ 38%]
tests/smart_selection/test_indexer.py::TestIndexerStatistics::test_get_index_stats PASSED [ 38%]
tests/smart_selection/test_integration.py::TestStartupIndexing::test_startup_indexes_all_enabled_sources PASSED [ 38%]
tests/smart_selection/test_integration.py::TestOnTheFlyIndexing::test_record_shown_indexes_unknown_image PASSED [ 39%]
tests/smart_selection/test_integration.py::TestRebuildIndex::test_rebuild_index_with_multiple_folders PASSED [ 39%]
tests/smart_selection/test_integration.py::TestStatsDisplay::test_stats_shows_indexing_when_zero PASSED [ 39%]
tests/smart_selection/test_models.py::TestImageRecord::test_image_record_creation_with_all_fields PASSED [ 40%]
tests/smart_selection/test_models.py::TestImageRecord::test_image_record_creation_with_defaults PASSED [ 40%]
tests/smart_selection/test_models.py::TestImageRecord::test_image_record_has_required_fields PASSED [ 40%]
tests/smart_selection/test_models.py::TestImageRecord::test_import_image_record PASSED [ 41%]
tests/smart_selection/test_models.py::TestSourceRecord::test_import_source_record PASSED [ 41%]
tests/smart_selection/test_models.py::TestSourceRecord::test_source_record_creation_with_defaults PASSED [ 41%]
tests/smart_selection/test_models.py::TestSourceRecord::test_source_record_has_required_fields PASSED [ 41%]
tests/smart_selection/test_models.py::TestPaletteRecord::test_import_palette_record PASSED [ 42%]
tests/smart_selection/test_models.py::TestPaletteRecord::test_palette_record_creation_with_defaults PASSED [ 42%]
tests/smart_selection/test_models.py::TestPaletteRecord::test_palette_record_has_color_fields PASSED [ 42%]
tests/smart_selection/test_models.py::TestPaletteRecord::test_palette_record_has_derived_metrics PASSED [ 43%]
tests/smart_selection/test_models.py::TestSelectionConstraints::test_import_selection_constraints PASSED [ 43%]
tests/smart_selection/test_models.py::TestSelectionConstraints::test_selection_constraints_defaults_to_no_filtering PASSED [ 43%]
tests/smart_selection/test_models.py::TestSelectionConstraints::test_selection_constraints_has_filter_fields PASSED [ 44%]
tests/smart_selection/test_palette.py::TestHexToHSL::test_hex_to_hsl_black PASSED [ 44%]
tests/smart_selection/test_palette.py::TestHexToHSL::test_hex_to_hsl_blue PASSED [ 44%]
tests/smart_selection/test_palette.py::TestHexToHSL::test_hex_to_hsl_green PASSED [ 45%]
tests/smart_selection/test_palette.py::TestHexToHSL::test_hex_to_hsl_lowercase PASSED [ 45%]
tests/smart_selection/test_palette.py::TestHexToHSL::test_hex_to_hsl_red PASSED [ 45%]
tests/smart_selection/test_palette.py::TestHexToHSL::test_hex_to_hsl_white PASSED [ 45%]
tests/smart_selection/test_palette.py::TestHexToHSL::test_import_hex_to_hsl PASSED [ 46%]
tests/smart_selection/test_palette.py::TestHSLToHex::test_hsl_to_hex_black PASSED [ 46%]
tests/smart_selection/test_palette.py::TestHSLToHex::test_hsl_to_hex_blue PASSED [ 46%]
tests/smart_selection/test_palette.py::TestHSLToHex::test_hsl_to_hex_clamps_values PASSED [ 47%]
tests/smart_selection/test_palette.py::TestHSLToHex::test_hsl_to_hex_gray PASSED [ 47%]
tests/smart_selection/test_palette.py::TestHSLToHex::test_hsl_to_hex_green PASSED [ 47%]
tests/smart_selection/test_palette.py::TestHSLToHex::test_hsl_to_hex_red PASSED [ 48%]
tests/smart_selection/test_palette.py::TestHSLToHex::test_hsl_to_hex_white PASSED [ 48%]
tests/smart_selection/test_palette.py::TestHSLToHex::test_import_hsl_to_hex PASSED [ 48%]
tests/smart_selection/test_palette.py::TestHSLToHex::test_roundtrip_conversion PASSED [ 49%]
tests/smart_selection/test_palette.py::TestColorTemperature::test_cool_color_negative_temperature PASSED [ 49%]
tests/smart_selection/test_palette.py::TestColorTemperature::test_import_calculate_temperature PASSED [ 49%]
tests/smart_selection/test_palette.py::TestColorTemperature::test_neutral_color_near_zero PASSED [ 50%]
tests/smart_selection/test_palette.py::TestColorTemperature::test_warm_color_positive_temperature PASSED [ 50%]
tests/smart_selection/test_palette.py::TestParsePalette::test_import_parse_wallust_json PASSED [ 50%]
tests/smart_selection/test_palette.py::TestParsePalette::test_parse_wallust_json_calculates_avg_metrics PASSED [ 50%]
tests/smart_selection/test_palette.py::TestParsePalette::test_parse_wallust_json_empty_input PASSED [ 51%]
tests/smart_selection/test_palette.py::TestParsePalette::test_parse_wallust_json_extracts_colors PASSED [ 51%]
tests/smart_selection/test_palette.py::TestParsePalette::test_parse_wallust_json_rgb_list_format PASSED [ 51%]
tests/smart_selection/test_palette.py::TestPaletteExtractor::test_extract_palette_includes_metrics PASSED [ 52%]
tests/smart_selection/test_palette.py::TestPaletteExtractor::test_extract_palette_nonexistent_file PASSED [ 52%]
tests/smart_selection/test_palette.py::TestPaletteExtractor::test_extract_palette_returns_dict PASSED [ 52%]
tests/smart_selection/test_palette.py::TestPaletteExtractor::test_import_palette_extractor PASSED [ 53%]
tests/smart_selection/test_palette.py::TestPaletteExtractor::test_is_wallust_available PASSED [ 53%]
tests/smart_selection/test_palette.py::TestPaletteExtractor::test_palette_extractor_creation PASSED [ 53%]
tests/smart_selection/test_palette.py::TestCreatePaletteRecord::test_create_palette_record PASSED [ 54%]
tests/smart_selection/test_palette.py::TestCreatePaletteRecord::test_import_create_palette_record PASSED [ 54%]
tests/smart_selection/test_palette.py::TestColorSimilarity::test_identical_palettes_similarity_one PASSED [ 54%]
tests/smart_selection/test_palette.py::TestColorSimilarity::test_import_palette_similarity PASSED [ 54%]
tests/smart_selection/test_palette.py::TestColorSimilarity::test_opposite_palettes_low_similarity PASSED [ 55%]
tests/smart_selection/test_palette.py::TestColorSimilarity::test_similar_palettes_high_similarity PASSED [ 55%]
tests/smart_selection/test_selector.py::TestSmartSelectorCreation::test_create_smart_selector PASSED [ 55%]
tests/smart_selection/test_selector.py::TestSmartSelectorCreation::test_import_smart_selector PASSED [ 56%]
tests/smart_selection/test_selector.py::TestSmartSelectorCreation::test_smart_selector_context_manager PASSED [ 56%]
tests/smart_selection/test_selector.py::TestSmartSelectorCreation::test_smart_selector_creates_database PASSED [ 56%]
tests/smart_selection/test_selector.py::TestSmartSelectorSelection::test_select_images_empty_database PASSED [ 57%]
tests/smart_selection/test_selector.py::TestSmartSelectorSelection::test_select_images_no_duplicates PASSED [ 57%]
tests/smart_selection/test_selector.py::TestSmartSelectorSelection::test_select_images_respects_count PASSED [ 57%]
tests/smart_selection/test_selector.py::TestSmartSelectorSelection::test_select_images_returns_filepaths PASSED [ 58%]
tests/smart_selection/test_selector.py::TestSmartSelectorSelection::test_select_images_returns_less_if_not_enough PASSED [ 58%]
tests/smart_selection/test_selector.py::TestSmartSelectorWeighting::test_favorites_selected_more_often PASSED [ 58%]
tests/smart_selection/test_selector.py::TestSmartSelectorWeighting::test_recently_shown_selected_less PASSED [ 58%]
tests/smart_selection/test_selector.py::TestSmartSelectorWeighting::test_selection_disabled_is_random PASSED [ 59%]
tests/smart_selection/test_selector.py::TestSmartSelectorRecordShown::test_record_shown_increments_times_shown PASSED [ 59%]
tests/smart_selection/test_selector.py::TestSmartSelectorRecordShown::test_record_shown_updates_image PASSED [ 59%]
tests/smart_selection/test_selector.py::TestSmartSelectorRecordShown::test_record_shown_updates_source PASSED [ 60%]
tests/smart_selection/test_selector.py::TestSmartSelectorConstraints::test_filter_by_aspect_ratio PASSED [ 60%]
tests/smart_selection/test_selector.py::TestSmartSelectorConstraints::test_filter_by_min_width PASSED [ 60%]
tests/smart_selection/test_selector.py::TestSmartSelectorConstraints::test_filter_by_sources PASSED [ 61%]
tests/smart_selection/test_selector.py::TestSmartSelectorConstraints::test_filter_favorites_only PASSED [ 61%]
tests/smart_selection/test_selector.py::TestColorAwareSelection::test_images_without_palette_excluded_when_color_filtering PASSED [ 61%]
tests/smart_selection/test_selector.py::TestColorAwareSelection::test_select_images_excludes_dissimilar_colors PASSED [ 62%]
tests/smart_selection/test_selector.py::TestColorAwareSelection::test_select_images_with_color_constraint_returns_similar PASSED [ 62%]
tests/smart_selection/test_selector.py::TestColorAwareSelection::test_selection_constraints_accepts_min_color_similarity PASSED [ 62%]
tests/smart_selection/test_selector.py::TestPreviewCandidates::test_get_preview_candidates_contains_expected_keys PASSED [ 62%]
tests/smart_selection/test_selector.py::TestPreviewCandidates::test_get_preview_candidates_respects_count PASSED [ 63%]
tests/smart_selection/test_selector.py::TestPreviewCandidates::test_get_preview_candidates_returns_list PASSED [ 63%]
tests/smart_selection/test_selector.py::TestPreviewCandidates::test_get_preview_candidates_sorted_by_weight PASSED [ 63%]
tests/smart_selection/test_selector.py::TestWeightedSelectionFloatPrecision::test_selection_handles_accumulated_float_error PASSED [ 64%]
tests/smart_selection/test_selector.py::TestWeightedSelectionFloatPrecision::test_selection_handles_float_precision_edge_case PASSED [ 64%]
tests/smart_selection/test_selector.py::TestWeightedSelectionFloatPrecision::test_selection_handles_tiny_float_differences PASSED [ 64%]
tests/smart_selection/test_selector.py::TestFileExistenceValidation::test_deleted_files_excluded_from_selection PASSED [ 65%]
tests/smart_selection/test_selector.py::TestFileExistenceValidation::test_missing_files_removed_from_candidates PASSED [ 65%]
tests/smart_selection/test_selector.py::TestStatisticsIntegration::test_get_statistics_analyzer_lazy_initialization PASSED [ 65%]
tests/smart_selection/test_selector.py::TestStatisticsIntegration::test_get_statistics_analyzer_returns_collection_statistics PASSED [ 66%]
tests/smart_selection/test_selector.py::TestStatisticsIntegration::test_rebuild_index_invalidates_statistics_cache PASSED [ 66%]
tests/smart_selection/test_selector.py::TestStatisticsIntegration::test_record_shown_invalidates_statistics_cache PASSED [ 66%]
tests/smart_selection/test_statistics.py::TestBasicFunctionality::test_empty_database PASSED [ 66%]
tests/smart_selection/test_statistics.py::TestBasicFunctionality::test_images_without_palettes PASSED [ 67%]
tests/smart_selection/test_statistics.py::TestBasicFunctionality::test_get_all_stats_structure PASSED [ 67%]
tests/smart_selection/test_statistics.py::TestCaching::test_cache_invalidation PASSED [ 67%]
tests/smart_selection/test_statistics.py::TestCaching::test_cache_revalidation PASSED [ 68%]
tests/smart_selection/test_statistics.py::TestGapDetection::test_no_gaps_with_balanced_distribution PASSED [ 68%]
tests/smart_selection/test_statistics.py::TestGapDetection::test_gap_detection_for_missing_category PASSED [ 68%]
tests/smart_selection/test_statistics.py::TestGapDetection::test_gap_detection_for_underrepresented_category PASSED [ 69%]
tests/smart_selection/test_statistics.py::TestGapDetection::test_gap_detection_hue_families PASSED [ 69%]
tests/smart_selection/test_statistics.py::TestGapDetection::test_gap_detection_ignores_neutral PASSED [ 69%]
tests/smart_selection/test_statistics.py::TestSummaryGeneration::test_lightness_summary_dominant PASSED [ 70%]
tests/smart_selection/test_statistics.py::TestSummaryGeneration::test_hue_summary_dominant_colors PASSED [ 70%]
tests/smart_selection/test_statistics.py::TestSummaryGeneration::test_freshness_summary_never_shown PASSED [ 70%]
tests/smart_selection/test_statistics.py::TestSummaryGeneration::test_summary_empty_database PASSED [ 70%]
tests/smart_selection/test_statistics.py::TestDistributions::test_lightness_buckets PASSED [ 71%]
tests/smart_selection/test_statistics.py::TestDistributions::test_hue_families PASSED [ 71%]
tests/smart_selection/test_statistics.py::TestDistributions::test_neutral_grayscale PASSED [ 71%]
tests/smart_selection/test_statistics.py::TestDistributions::test_freshness_ranges PASSED [ 72%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_apply_filter_darken PASSED [ 72%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_apply_filter_strip PASSED [ 72%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_apply_filter_with_spaces PASSED [ 73%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_apply_filters_chain PASSED [ 73%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_apply_filters_complex_chain PASSED [ 73%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_blend_averages_colors PASSED [ 74%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_blend_with_missing_color PASSED [ 74%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_darken_clamps_to_zero PASSED [ 74%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_darken_reduces_lightness PASSED [ 75%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_desaturate_decreases_saturation PASSED [ 75%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_desaturate_to_gray PASSED [ 75%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_import_color_transformer PASSED [ 75%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_invalid_filter_argument_returns_original PASSED [ 76%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_lighten_clamps_to_one PASSED [ 76%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_lighten_increases_lightness PASSED [ 76%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_saturate_increases_saturation PASSED [ 77%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_strip_handles_no_hash PASSED [ 77%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_strip_removes_hash PASSED [ 77%]
tests/smart_selection/test_theming.py::TestColorTransformer::test_unknown_filter_returns_original PASSED [ 78%]
tests/smart_selection/test_theming.py::TestColorsEquivalent::test_case_insensitive PASSED [ 78%]
tests/smart_selection/test_theming.py::TestColorsEquivalent::test_custom_tolerance PASSED [ 78%]
tests/smart_selection/test_theming.py::TestColorsEquivalent::test_identical_colors_are_equivalent PASSED [ 79%]
tests/smart_selection/test_theming.py::TestColorsEquivalent::test_import_colors_equivalent PASSED [ 79%]
tests/smart_selection/test_theming.py::TestColorsEquivalent::test_one_off_colors_are_equivalent PASSED [ 79%]
tests/smart_selection/test_theming.py::TestColorsEquivalent::test_two_off_colors_are_not_equivalent PASSED [ 79%]
tests/smart_selection/test_theming.py::TestHexRgbConversion::test_hex_to_rgb PASSED [ 80%]
tests/smart_selection/test_theming.py::TestHexRgbConversion::test_hex_to_rgb_without_hash PASSED [ 80%]
tests/smart_selection/test_theming.py::TestHexRgbConversion::test_rgb_to_hex PASSED [ 80%]
tests/smart_selection/test_theming.py::TestHexRgbConversion::test_rgb_to_hex_clamps_values PASSED [ 81%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_comment_stripping PASSED [ 81%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_complex_filter_chain PASSED [ 81%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_import_template_processor PASSED [ 82%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_multiline_comment PASSED [ 82%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_multiple_variables_in_template PASSED [ 82%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_preserves_non_variable_content PASSED [ 83%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_real_hyprland_template_line PASSED [ 83%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_simple_variable_substitution PASSED [ 83%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_unknown_variable_preserved PASSED [ 83%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_variable_with_filter_chain PASSED [ 84%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_variable_with_single_filter PASSED [ 84%]
tests/smart_selection/test_theming.py::TestTemplateProcessor::test_whitespace_handling PASSED [ 84%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_apply_processes_template PASSED [ 85%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_apply_returns_false_for_missing_palette PASSED [ 85%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_atomic_write PASSED [ 85%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_cleanup_cancels_timer PASSED [ 86%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_empty_palette_returns_false PASSED [ 86%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_import_default_reloads PASSED [ 86%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_import_template_config PASSED [ 87%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_import_theme_engine PASSED [ 87%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_is_enabled PASSED [ 87%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_load_templates_from_wallust_toml PASSED [ 87%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_missing_wallust_config PASSED [ 88%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_palette_fallbacks PASSED [ 88%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_reload_command_override PASSED [ 88%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_reload_config PASSED [ 89%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_template_caching PASSED [ 89%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_toml_fallback_target_first_order PASSED [ 89%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_variety_config_disables_template PASSED [ 90%]
tests/smart_selection/test_theming.py::TestThemeEngine::test_variety_config_global_disable PASSED [ 90%]
tests/smart_selection/test_weights.py::TestRecencyFactor::test_exponential_decay PASSED [ 90%]
tests/smart_selection/test_weights.py::TestRecencyFactor::test_import_recency_factor PASSED [ 91%]
tests/smart_selection/test_weights.py::TestRecencyFactor::test_linear_decay PASSED [ 91%]
tests/smart_selection/test_weights.py::TestRecencyFactor::test_never_shown_returns_one PASSED [ 91%]
tests/smart_selection/test_weights.py::TestRecencyFactor::test_shown_after_cooldown_returns_one PASSED [ 91%]
tests/smart_selection/test_weights.py::TestRecencyFactor::test_shown_halfway_cooldown_partial_factor PASSED [ 92%]
tests/smart_selection/test_weights.py::TestRecencyFactor::test_shown_today_returns_zero PASSED [ 92%]
tests/smart_selection/test_weights.py::TestRecencyFactor::test_step_decay PASSED [ 92%]
tests/smart_selection/test_weights.py::TestRecencyFactor::test_zero_cooldown_always_returns_one PASSED [ 93%]
tests/smart_selection/test_weights.py::TestSourceFactor::test_import_source_factor PASSED [ 93%]
tests/smart_selection/test_weights.py::TestSourceFactor::test_source_never_shown_returns_one PASSED [ 93%]
tests/smart_selection/test_weights.py::TestSourceFactor::test_source_shown_after_cooldown_returns_one PASSED [ 94%]
tests/smart_selection/test_weights.py::TestSourceFactor::test_source_shown_recently_returns_low_factor PASSED [ 94%]
tests/smart_selection/test_weights.py::TestBoostFactors::test_favorite_boost_for_favorite PASSED [ 94%]
tests/smart_selection/test_weights.py::TestBoostFactors::test_favorite_boost_for_non_favorite PASSED [ 95%]
tests/smart_selection/test_weights.py::TestBoostFactors::test_import_favorite_boost PASSED [ 95%]
tests/smart_selection/test_weights.py::TestBoostFactors::test_import_new_image_boost PASSED [ 95%]
tests/smart_selection/test_weights.py::TestBoostFactors::test_new_image_boost_for_never_shown PASSED [ 95%]
tests/smart_selection/test_weights.py::TestBoostFactors::test_new_image_boost_for_shown_image PASSED [ 96%]
tests/smart_selection/test_weights.py::TestCalculateWeight::test_calculate_weight_combines_factors PASSED [ 96%]
tests/smart_selection/test_weights.py::TestCalculateWeight::test_calculate_weight_favorite_higher PASSED [ 96%]
tests/smart_selection/test_weights.py::TestCalculateWeight::test_calculate_weight_new_image_higher PASSED [ 97%]
tests/smart_selection/test_weights.py::TestCalculateWeight::test_calculate_weight_recently_shown_lower PASSED [ 97%]
tests/smart_selection/test_weights.py::TestCalculateWeight::test_calculate_weight_source_cooldown PASSED [ 97%]
tests/smart_selection/test_weights.py::TestCalculateWeight::test_calculate_weight_with_defaults PASSED [ 98%]
tests/smart_selection/test_weights.py::TestCalculateWeight::test_import_calculate_weight PASSED [ 98%]
tests/smart_selection/test_weights.py::TestWeightDisabled::test_calculate_weight_returns_one_when_disabled PASSED [ 98%]
tests/smart_selection/test_weights.py::TestNegativeTimeGuard::test_future_timestamp_handled_gracefully PASSED [ 99%]
tests/smart_selection/test_weights.py::TestNegativeTimeGuard::test_negative_elapsed_time_returns_minimum_factor PASSED [ 99%]
tests/smart_selection/test_weights.py::TestMinimumWeightFloor::test_weight_is_finite PASSED [ 99%]
tests/smart_selection/test_weights.py::TestMinimumWeightFloor::test_weight_never_zero PASSED [100%]

=============================== warnings summary ===============================
variety/__init__.py:18
  /home/komi/repos/variety-variation/variety/__init__.py:18: DeprecationWarning: Importing dbus.glib to use the GLib main loop with dbus-python is deprecated.
  Instead, use this sequence:
  
      from dbus.mainloop.glib import DBusGMainLoop
  
      DBusGMainLoop(set_as_default=True)
  
    import dbus, dbus.service, dbus.glib

variety/ThumbsWindow.py:31
  /home/komi/repos/variety-variation/variety/ThumbsWindow.py:31: PyGIDeprecationWarning: GObject.SIGNAL_RUN_FIRST is deprecated; use GObject.SignalFlags.RUN_FIRST instead
    __gsignals__ = {"clicked": (GObject.SIGNAL_RUN_FIRST, None, (str, Gtk.Widget, object))}

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

--------------------------------------------------------------------------------------------------------------- benchmark: 23 tests ---------------------------------------------------------------------------------------------------------------
Name (time in us)                                 Min                       Max                      Mean                  StdDev                    Median                     IQR            Outliers           OPS            Rounds  Iterations
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_bench_create_palette_record               1.3010 (1.0)          1,175.1240 (1.08)             2.1762 (1.0)            8.9935 (1.0)              1.4570 (1.0)            0.8680 (3.73)     723;3591  459,506.6854 (1.0)      117385           1
test_bench_get_all_sources                     2.2100 (1.70)         1,704.3760 (1.56)             3.5139 (1.61)          11.5415 (1.28)             2.3330 (1.60)           0.6660 (2.86)     618;8846  284,581.7290 (0.62)      65181           1
test_bench_get_source                          2.2340 (1.72)         2,788.6330 (2.56)             3.3617 (1.54)          13.8504 (1.54)             2.3620 (1.62)           0.2330 (1.0)     610;21759  297,465.2776 (0.65)      96853           1
test_bench_palette_similarity                  3.8350 (2.95)         2,431.7440 (2.23)             6.3430 (2.91)          20.2065 (2.25)             4.2770 (2.94)           2.8050 (12.04)    480;1660  157,652.9045 (0.34)      49690           1
test_bench_get_image_by_path                   4.0870 (3.14)         3,265.4700 (2.99)             6.4164 (2.95)          26.0757 (2.90)             4.2990 (2.95)           1.7060 (7.32)     452;6918  155,850.1249 (0.34)      59341           1
test_bench_record_image_shown                  4.5800 (3.52)         3,440.9260 (3.15)            10.3488 (4.76)          37.6310 (4.18)             5.6730 (3.89)           7.4060 (31.78)     184;471   96,630.0109 (0.21)      17278           1
test_bench_upsert_image                        5.9450 (4.57)         1,653.1180 (1.51)             9.6742 (4.45)          26.1076 (2.90)             6.9210 (4.75)           2.2155 (9.51)     253;1690  103,367.7479 (0.22)      20261           1
test_bench_upsert_palette                      5.9590 (4.58)         2,031.7150 (1.86)             9.5178 (4.37)          25.7260 (2.86)             6.7110 (4.61)           1.1955 (5.13)     265;3277  105,066.3031 (0.23)      18091           1
test_bench_get_palette                         6.7260 (5.17)         1,091.2760 (1.0)              9.4042 (4.32)          19.9076 (2.21)             7.0030 (4.81)           0.4140 (1.78)     419;5841  106,335.0656 (0.23)      26070           1
test_bench_record_shown                       16.7420 (12.87)        1,934.6470 (1.77)            26.9257 (12.37)         36.9646 (4.11)            18.2720 (12.54)          7.6845 (32.98)    492;2088   37,139.2082 (0.08)      15764           1
test_bench_scan_directory                     17.7720 (13.66)        2,790.9350 (2.56)            26.5239 (12.19)         38.8144 (4.32)            18.4940 (12.69)          7.0475 (30.24)    671;2856   37,701.8398 (0.08)      25396           1
test_bench_get_all_images                     22.0350 (16.94)        1,165.2510 (1.07)            29.6020 (13.60)         30.4768 (3.39)            22.6430 (15.54)          5.4850 (23.54)     256;763   33,781.4975 (0.07)       6989           1
test_bench_get_favorite_images                22.5100 (17.30)        3,254.2550 (2.98)            31.4394 (14.45)         48.5317 (5.40)            23.2740 (15.97)          7.8075 (33.51)    358;1247   31,807.2255 (0.07)      15793           1
test_bench_weight_calculation                 26.4880 (20.36)        2,305.0980 (2.11)            39.7833 (18.28)         45.6350 (5.07)            28.4750 (19.54)         10.4743 (44.95)    941;2427   25,136.1599 (0.05)      23445           1
test_bench_disabled_selection                 30.9770 (23.81)        1,927.2460 (1.77)            53.3354 (24.51)         60.6414 (6.74)            37.2450 (25.56)         30.7262 (131.86)    441;476   18,749.2606 (0.04)      11073           1
test_bench_select_single                      58.2310 (44.76)        2,092.6820 (1.92)            97.5674 (44.83)         75.8232 (8.43)            68.7495 (47.19)         51.6750 (221.76)    649;498   10,249.3261 (0.02)       8490           1
test_bench_select_with_constraints            58.6450 (45.08)        2,099.6160 (1.92)            90.3556 (41.52)         61.5708 (6.85)            67.7930 (46.53)         35.3208 (151.58)    661;694   11,067.3872 (0.02)       7477           1
test_bench_select_batch                       60.4330 (46.45)        1,912.9360 (1.75)           101.4074 (46.60)         84.3432 (9.38)            69.8580 (47.95)         46.2410 (198.44)    511;583    9,861.2119 (0.02)       7001           1
test_bench_reindex_existing                  169.8360 (130.54)       3,447.0540 (3.16)           296.9998 (136.47)       184.0565 (20.47)          235.4375 (161.59)       123.8230 (531.38)    376;279    3,367.0055 (0.01)       3698           1
test_bench_index_single_file                 309.8300 (238.15)       3,141.0110 (2.88)           483.5785 (222.21)       224.2829 (24.94)          415.2160 (284.98)       171.7353 (737.00)      37;20    2,067.9168 (0.00)        439           1
test_bench_index_directory                   850.8290 (653.98)       4,779.8550 (4.38)         1,274.7044 (585.74)       424.5948 (47.21)        1,172.5800 (804.78)       345.9242 (>1000.0)     51;39      784.4956 (0.00)        557           1
test_bench_extract_palette               245,597.7780 (>1000.0)    337,949.4070 (309.68)     290,476.4968 (>1000.0)   35,493.5424 (>1000.0)    288,961.8350 (>1000.0)   52,491.5942 (>1000.0)       2;0        3.4426 (0.00)          5           1
test_bench_extract_batch_palettes      4,438,659.9440 (>1000.0)  4,786,143.8060 (>1000.0)  4,649,901.6768 (>1000.0)  153,290.0792 (>1000.0)  4,724,089.1600 (>1000.0)  255,586.9410 (>1000.0)       1;0        0.2151 (0.00)          5           1
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Legend:
  Outliers: 1 Standard Deviation from Mean; 1.5 IQR (InterQuartile Range) from 1st Quartile and 3rd Quartile.
  OPS: Operations Per Second, computed as 1 / Mean
============ 322 passed, 2 skipped, 2 warnings in 69.09s (0:01:09) =============
